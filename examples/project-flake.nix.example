# project-flake.nix.example
#
# Example flake.nix to use in INDIVIDUAL PROJECTS
# 
# How to use:
# 1. Copy to the project directory: cp project-flake.nix.example /path/to/project/flake.nix
# 2. Customize buildInputs with your project dependencies
# 3. Enter the environment: nix develop
#
# ==========================================

# ==========================================
# Example 1: Pure Rust Project
# ==========================================
{
  description = "My Rust project";
  
  inputs = {
    nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";
    fenix = {
      url = "github:nix-community/fenix";
      inputs.nixpkgs.follows = "nixpkgs";
    };
  };
  
  outputs = { self, nixpkgs, fenix }:
    let
      system = "x86_64-linux";
      pkgs = nixpkgs.legacyPackages.${system};
      fenixPkgs = fenix.packages.${system};
      
      rustToolchain = fenixPkgs.stable.withComponents [
        "rustc" "cargo" "clippy" "rustfmt" "rust-analyzer"
      ];
    in {
      devShells.${system}.default = pkgs.mkShell {
        buildInputs = with pkgs; [
          rustToolchain
          
          # Project-specific deps
          postgresql  # For sqlx/diesel
          openssl
          pkg-config
          
          # Extra tools
          cargo-watch
          cargo-edit
        ];
        
        shellHook = ''
          echo "ü¶Ä Rust Project Environment"
          rustc --version
        '';
      };
    };
}

# ==========================================
# Example 2: Go Project with Postgres
# ==========================================
# {
#   description = "My Go project";
#   
#   inputs.nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";
#   
#   outputs = { self, nixpkgs }:
#     let
#       system = "x86_64-linux";
#       pkgs = nixpkgs.legacyPackages.${system};
#     in {
#       devShells.${system}.default = pkgs.mkShell {
#         buildInputs = with pkgs; [
#           go_1_25
#           gopls
#           delve
#           golangci-lint
#           
#           # Project deps
#           postgresql
#           redis
#         ];
#         
#         shellHook = ''
#           echo "üêπ Go Project Environment"
#           go version
#           export GOPATH=$HOME/go
#           export PATH=$GOPATH/bin:$PATH
#         '';
#       };
#     };
# }

# ==========================================
# Example 3: Full Stack (Rust Backend + Node Frontend)
# ==========================================
# {
#   description = "Full Stack Project";
#   
#   inputs = {
#     nixpkgs.url = "github:NixOS/nixpkgs/nixos-unstable";
#     fenix.url = "github:nix-community/fenix";
#   };
#   
#   outputs = { self, nixpkgs, fenix }:
#     let
#       system = "x86_64-linux";
#       pkgs = nixpkgs.legacyPackages.${system};
#       rustToolchain = fenix.packages.${system}.stable.withComponents [
#         "rustc" "cargo" "rust-analyzer"
#       ];
#     in {
#       devShells.${system}.default = pkgs.mkShell {
#         buildInputs = with pkgs; [
#           # Backend (Rust)
#           rustToolchain
#           openssl
#           pkg-config
#           
#           # Frontend (Node)
#           nodejs_20
#           nodePackages.pnpm
#           
#           # Database
#           postgresql
#           
#           # Tools
#           just  # command runner
#           sqlx-cli  # migrations
#         ];
#         
#         shellHook = ''
#           echo "üöÄ Full Stack Environment"
#           echo "Backend: $(rustc --version)"
#           echo "Frontend: $(node --version)"
#         '';
#       };
#     };
# }

# ==========================================
# Example 4: Use flake from nixos-config
# ==========================================
# If you just want to reference shells from your nixos-config:
# 
# {
#   description = "Project using nixos-config shells";
#   
#   inputs = {
#     nixos-config.url = "path:/home/borba/nixos-config";
#   };
#   
#   outputs = { self, nixos-config }:
#     let
#       system = "x86_64-linux";
#     in {
#       # Reuses the shell from nixos-config
#       devShells.${system}.default = nixos-config.devShells.${system}.rust;
#     };
# }
